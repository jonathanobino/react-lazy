{"mappings":"mJAGe,SAAAA,EAA6BC,GAC1C,IAAKC,EAAQC,EAAMC,GAAcC,EAAgBJ,GAEjD,MAAOK,EAAOC,IAAY,EAAAC,EAAAC,UAAS,CACjCC,gBAAiB,OAAOP,QACrBF,EAAMK,QAUX,OAPA,EAAAE,EAAAG,YAAU,KACRJ,EAAS,CACPG,gBAAiB,OAAOP,QACrBF,EAAMK,UAEV,CAACH,EAAMC,KAGR,EAAAQ,EAAAC,KAAC,MAAG,CACFC,UAAWb,EAAMa,UACjBR,MAAOA,EACPS,IAAMC,IACJd,EAAOc,aAGRf,EAAMgB,WCvBE,SAAAC,EAAmBjB,GAChC,MAAOC,EAAQC,GAAQE,EAAgBJ,GAEvC,OACE,EAAAW,EAAAC,KAAC,MAAG,CACFE,IAAMC,IACJd,EAAOc,cAGT,EAAAJ,EAAAC,KAAC,MAAG,CACFM,IAAKhB,EACLiB,IAAKnB,EAAMmB,IACXd,MAAOL,EAAMK,MACbQ,UAAWb,EAAMa,cCbV,SAAAO,EAAmBpB,GAChC,IAAKC,EAAQC,GAAQE,EAAgBJ,GAErC,OACE,EAAAW,EAAAC,KAAC,SAAM,CACLS,OAAQrB,EAAMqB,QAAU,MACxBC,UAAWtB,EAAMsB,WAAa,KAC9BJ,IAAKhB,EACLqB,YAAavB,EAAMuB,aAAe,KAClCC,gBAAiBxB,EAAMwB,kBAAmB,EAC1CnB,MAAOL,EAAMK,OAAS,GACtBS,IAAMC,IACJd,EAAOc,OAELf,ICdK,SAAAyB,EAAuBzB,GACpC,MAAOC,EAAQC,EAAMwB,GAAatB,EAAgBJ,GAElD,OAAK0B,GAcE,EAAAf,EAAAC,KAAC,MAAG,UAAEZ,EAAMgB,YAZf,EAAAL,EAAAC,KAAC,MAAG,CACFE,IAAMC,IACJd,EAAOc,IAETV,MAAO,CACLgB,OAAQ,QACRM,MAAO,WACJ3B,EAAMK,SCPJ,SAAAD,EAA+BJ,GAI5C,MAAOE,EAAM0B,IAAW,EAAArB,EAAAC,UAAS,KAC1BqB,EAASC,IAAc,EAAAvB,EAAAC,WAAS,GAEvC,IAAKM,EAAKb,IAAU,EAAAM,EAAAC,UAAS,MAE7B,MAAMuB,GAAe,EAAAxB,EAAAyB,UAAQ,KACpB,CACLC,QAASnB,gBACToB,EACAC,OAAQnC,EAAMmC,QAAU,OAEzB,CAACrB,EAAKd,IAEHoC,GAAS,EAAA7B,EAAA8B,cAAatB,IACb,OAATA,GAAed,EAAOc,KACzB,IAEH,SAASmB,IACJlC,EAAME,MACP0B,GAAQ,IAAM5B,EAAME,OACtB4B,GAAW,KAAM,IAYnB,OATA,EAAAvB,EAAAG,YAAU,KACI,OAARI,GAEFwB,EAAcC,WAAWR,GACpB,IAELO,EAAcE,sBAAsBT,KACrC,CAACjB,IAEG,CAACsB,EAAQlC,EAAM2B,+RAIxB,IAAIY,EAA8B,GAElC,MAAMH,EAAgB,CAIpBI,aAAc,EAACP,OACbA,EAAMQ,IACNA,EAAGC,KACHA,KAKID,EAAME,OAAOC,YAAcX,GAAUS,EAAOC,OAAOE,WAAaZ,EAEtEa,qBAAuBC,IACrB,MAAMN,IAAEA,EAAGC,KAAEA,GAASK,EAAKhB,SAASiB,yBAA2B,CAC7DP,IAAK,EACLC,KAAM,GAGR,MAAO,IACFK,MACHN,OACAC,IAGJL,WAAY,SAAUN,GAEpBQ,EAASU,KAAKlB,GAE2B,IAArCK,EAAcc,qBAChBd,EAAcc,mBAAqBP,OAAOQ,sBACxCf,EAAcgB,gBAIpBA,aAAc,WAEY,IAApBb,EAASc,OACXjB,EAAckB,uBAEdf,EAASgB,SAAQ,CAACR,EAAMS,KACHpB,EAAcI,aAC/BJ,EAAcU,qBAAqBC,MAGnCA,EAAKf,gBAELI,EAAcE,sBAAsBS,OAGxCX,EAAcc,mBAAqBP,OAAOQ,sBACxCf,EAAcgB,gBAKpBE,oBAAqB,WACnBX,OAAOc,qBAAqBrB,EAAcc,oBAC1Cd,EAAcc,mBAAqB,GAGrCZ,sBAAuB,SAAUoB,GAC/BnB,EAAWA,EAASoB,QAAQZ,GAASA,IAASW,KAEhDR,mBAAoB","sources":["src/lazyLoadBackgroundImage.tsx","src/lazyLoadImage.tsx","src/lazyLoadFrame.tsx","src/lazyLoadComponent.tsx","src/useIsInViewport.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react' // eslint-disable-line no-unused-vars\nimport useIsInViewPort from './index'\n\nexport default function LazyBackgroundImage(props: any) {\n  let [setRef, link, isViewable] = useIsInViewPort(props)\n\n  const [style, setStyle] = useState({\n    backgroundImage: `url(${link})`,\n    ...props.style,\n  })\n\n  useEffect(() => {\n    setStyle({\n      backgroundImage: `url(${link})`,\n      ...props.style,\n    })\n  }, [link, isViewable])\n\n  return (\n    <div\n      className={props.className}\n      style={style}\n      ref={(node) => {\n        setRef(node)\n      }}\n    >\n      {props.children}\n    </div>\n  )\n}\n","import React from 'react' // eslint-disable-line no-unused-vars\nimport useIsInViewPort from './index'\n\nexport default function LazyImage(props: any) {\n  const [setRef, link] = useIsInViewPort(props)\n\n  return (\n    <div\n      ref={(node) => {\n        setRef(node)\n      }}\n    >\n      <img\n        src={link}\n        alt={props.alt}\n        style={props.style}\n        className={props.className}\n      />\n    </div>\n  )\n}\n","import React from 'react' // eslint-disable-line no-unused-vars\nimport useIsInViewPort from './index'\n\nexport default function LazyFrame(props: any) {\n  let [setRef, link] = useIsInViewPort(props)\n\n  return (\n    <iframe\n      height={props.height || '500'}\n      scrolling={props.scrolling || 'no'}\n      src={link}\n      frameBorder={props.frameBorder || 'no'}\n      allowFullScreen={props.allowFullScreen || true}\n      style={props.style || {}}\n      ref={(node) => {\n        setRef(node)\n      }}\n      {...props}\n    />\n  )\n}\n","import React from 'react'\nimport useIsInViewport from './index'\n\nexport default function LazyComponent(props: any) {\n  const [setRef, link, isVisible] = useIsInViewport(props)\n\n  if (!isVisible)\n    return (\n      <div\n        ref={(node) => {\n          setRef(node)\n        }}\n        style={{\n          height: '300px',\n          width: '300px',\n          ...props.style,\n        }}\n      ></div>\n    )\n\n  return <div>{props.children}</div>\n}\n","import React, { useState, useEffect, useMemo, useCallback } from 'react' // eslint-disable-line no-unused-vars\n\ninterface InstanceElement {\n  makeItVisible: () => void\n  element: HTMLElement | null\n  offset: number\n}\n\nexport default function useRenderIfInViewPort(props: {\n  link: string\n  offset: number\n}): [Function, string, boolean] {\n  const [link, setLink] = useState('')\n  const [visible, setVisible] = useState(false)\n\n  let [ref, setRef] = useState(null)\n\n  const thisInstance = useMemo(() => {\n    return {\n      element: ref,\n      makeItVisible,\n      offset: props.offset || 100,\n    }\n  }, [ref, props])\n\n  const getRef = useCallback((node) => {\n    if (node !== null) setRef(node)\n  }, [])\n\n  function makeItVisible() {\n    if(props.link)\n      setLink(() => props.link)\n    setVisible(() => true)\n  }\n\n  useEffect(() => {\n    if (ref !== null)\n      // add the element to the array of elements that are waiting to be lazy loaded\n      CheckIfRender.addElement(thisInstance)\n    return () =>\n      // if the element is unloaded remove the element from the list of elements that needs to be lazy loader\n      CheckIfRender.removeElementFromList(thisInstance)\n  }, [ref])\n\n  return [getRef, link, visible]\n}\n\n// array with all the elements that are waiting to be shown in the viewport\nlet elements: InstanceElement[] = []\n\nconst CheckIfRender = {\n  // top: the position of the element in relation with the top of the browser\n  // left: the position of the element in relation with the left of the browser\n  // offset: the desired offset of the element in relation of the viewport\n  isInViewPort: ({\n    offset,\n    top,\n    left,\n  }: {\n    offset: number\n    top: number\n    left: number\n  }) => top < window.innerHeight + offset && left < window.innerWidth + offset,\n\n  calculateNewPosition: (elem: InstanceElement) => {\n    const { top, left } = elem.element?.getBoundingClientRect() || {\n      top: 0,\n      left: 0,\n    }\n\n    return {\n      ...elem,\n      top,\n      left,\n    }\n  },\n  addElement: function (element: InstanceElement) {\n    //the distance from the pixel 0,0 and the top of the element\n    elements.push(element)\n    //check if has already been started the rAF cycle\n    if (CheckIfRender.isListenerAttached === 0) {\n      CheckIfRender.isListenerAttached = window.requestAnimationFrame(\n        CheckIfRender.eventHandler\n      )\n    }\n  },\n  eventHandler: function () {\n    //if there is no more element to lazy load remove the listener/rAF\n    if (elements.length === 0) {\n      CheckIfRender.removeScrollHandler()\n    } else {\n      elements.forEach((elem, i) => {\n        const haveToShow = CheckIfRender.isInViewPort(\n          CheckIfRender.calculateNewPosition(elem)\n        )\n        if (haveToShow) {\n          elem.makeItVisible()\n          // remove element from the list of elements to lazy load\n          CheckIfRender.removeElementFromList(elem)\n        }\n      })\n      CheckIfRender.isListenerAttached = window.requestAnimationFrame(\n        CheckIfRender.eventHandler\n      )\n    }\n  },\n\n  removeScrollHandler: function () {\n    window.cancelAnimationFrame(CheckIfRender.isListenerAttached)\n    CheckIfRender.isListenerAttached = 0\n  },\n  //When an element is unloaded remove it from the list of elements that are waiting to be lazy-loaded\n  removeElementFromList: function (toRemove: InstanceElement) {\n    elements = elements.filter((elem) => elem !== toRemove)\n  },\n  isListenerAttached: 0, // intended as not set\n}\n\nexport { CheckIfRender }\n"],"names":["$6e38eea936045ca0$export$2e2bcd8739ae039","props","setRef","link","isViewable","$03b515f3f8c77d8f$export$2e2bcd8739ae039","style","setStyle","$9w1Q4$react","useState","backgroundImage","useEffect","$9w1Q4$reactjsxruntime","jsx","className","ref","node","children","$f6f596272f209e0c$export$2e2bcd8739ae039","src","alt","$8e3d626f2d1eebd8$export$2e2bcd8739ae039","height","scrolling","frameBorder","allowFullScreen","$c17687259f8b5ddf$export$2e2bcd8739ae039","isVisible","width","setLink","visible","setVisible","thisInstance","useMemo","element","makeItVisible","offset","getRef","useCallback","$03b515f3f8c77d8f$export$8ed7e1fb47d2eef9","addElement","removeElementFromList","$03b515f3f8c77d8f$var$elements","isInViewPort","top","left","window","innerHeight","innerWidth","calculateNewPosition","elem","getBoundingClientRect","push","isListenerAttached","requestAnimationFrame","eventHandler","length","removeScrollHandler","forEach","i","cancelAnimationFrame","toRemove","filter"],"version":3,"file":"index.js.map"}